-- ‚ö° Ultra Instant TP Auto Candy Farm (Safe ServerHop + Continuous Auto Farm + GUI)
-- Author: Capm (modified with serverhop by Durckzdf)

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

--- SETTINGS
local targetActionText = "Open"
local teleportOffset = Vector3.new(0, 3, 0)
local autoFarm = true
local teleportDelay = 0
local loopDelay = 0.01
local clickBurst = 3
local checkEmptyDelay = 1
local serverHopCooldown = 30
local lastServerHop = 0

--- GUI Setup
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "CandyFarmGUI"
ScreenGui.Parent = player:WaitForChild("PlayerGui")

local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0, 150, 0, 50)
ToggleButton.Position = UDim2.new(0.05,0,0.05,0)
ToggleButton.BackgroundColor3 = Color3.fromRGB(255, 165, 0)
ToggleButton.TextColor3 = Color3.new(1,1,1)
ToggleButton.TextScaled = true
ToggleButton.Text = "Auto Farm: ON"
ToggleButton.Parent = ScreenGui

ToggleButton.MouseButton1Click:Connect(function()
autoFarm = not autoFarm
if autoFarm then
ToggleButton.Text = "Auto Farm: ON"
print("üéÉ Auto Farm ENABLED")
else
ToggleButton.Text = "Auto Farm: OFF"
print("‚è∏ Auto Farm PAUSED")
end
end)

--- Re-get HRP when respawning
player.CharacterAdded:Connect(function(newChar)
char = newChar
hrp = char:WaitForChild("HumanoidRootPart")
task.wait(2) -- ‡∏£‡∏≠ environment ‡πÇ‡∏´‡∏•‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏°
print("üßô Respawned, continuing auto farm...")
end)

--- Get BasePart from Attachment
local function getBasePartFromAttachment(attachment)
if not attachment or not attachment:IsA("Attachment") then return nil end
local parent = attachment.Parent
while parent and not parent:IsA("BasePart") do
parent = parent.Parent
end
return parent
end

--- Teleport + Rapid Trigger
local function teleportAndTrigger(prompt)
if not prompt or not prompt:IsA("ProximityPrompt") then return end
if not hrp or not hrp.Parent then return end

```
local attachment = prompt.Parent
local part = getBasePartFromAttachment(attachment)
if not part then return end

pcall(function()
	prompt.HoldDuration = 0
	prompt.RequiresLineOfSight = false
	prompt.MaxActivationDistance = math.huge
end)

hrp.CFrame = part.CFrame + teleportOffset
for i = 1, clickBurst do
	task.defer(function()
		pcall(function()
			fireproximityprompt(prompt, 1)
		end)
	end)
end
```

end

--- Find all "Open" prompts
local function getAllOpenPrompts()
local prompts = {}
for _, obj in ipairs(workspace:GetDescendants()) do
if obj:IsA("ProximityPrompt") and obj.Enabled and obj.ActionText:lower() == targetActionText:lower() then
table.insert(prompts, obj)
end
end
return prompts
end

--- Safe Server Hop
local function serverHop()
if tick() - lastServerHop < serverHopCooldown then return end
lastServerHop = tick()

```
print("üåê No doors left! Attempting server hop...")

local success, data = pcall(function()
	return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?sortOrder=Asc&limit=100"))
end)
if not success or not data or not data.data then
	warn("‚ùå Failed to get server list. Retrying in 5s...")
	task.wait(5)
	return serverHop()
end

local servers = {}
for _, s in ipairs(data.data) do
	if s.playing < s.maxPlayers and s.id ~= game.JobId then
		table.insert(servers, s)
	end
end

if #servers > 0 then
	local target = servers[math.random(1, #servers)]
	print("üõ∞ Hopping to public server:", target.id)

	queue_on_teleport([[
		print("üéÉ Auto Candy Farm Reloading on new server...")
		loadstring(game:HttpGet("https://raw.githubusercontent.com/ainthewolrd-collab/sss/refs/heads/main/JJS%20AUTO"))()
		task.wait(2) -- ‡∏£‡∏≠ environment server ‡πÉ‡∏´‡∏°‡πà
	]])

	local ok, err = pcall(function()
		TeleportService:TeleportToPlaceInstance(game.PlaceId, target.id, player)
	end)
	if not ok then
		warn("‚ùå Teleport failed:", err, "Retrying in 2s...")
		task.wait(2)
		return serverHop()
	end
else
	print("‚ö†Ô∏è No available public servers found. Retrying in 5s...")
	task.wait(5)
	return serverHop()
end
```

end

--- Infinite teleport loop for continuous auto farm
task.spawn(function()
while true do
task.wait(loopDelay)
if autoFarm and hrp and hrp.Parent then
local prompts = getAllOpenPrompts()
if #prompts == 0 then
task.wait(checkEmptyDelay)
local again = getAllOpenPrompts()
if #again == 0 then
serverHop()
end
else
for i, prompt in ipairs(prompts) do
if not autoFarm then break end
task.spawn(teleportAndTrigger, prompt)
if i % 10 == 0 then task.wait(0.02) end
end
end
end
end
end)

print("üéÉ Ultra Instant TP Auto Candy Farm (Safe ServerHop + Continuous + GUI Ready) Loaded!")
